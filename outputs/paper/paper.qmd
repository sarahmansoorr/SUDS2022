---
#### Preamble ####
title: "Disparities in Climate-Induced Health Outcomes in the Greater Toronto Area."
author: "Sarah Mansoor"
email: "sarah.mansoor@mail.utoronto.ca"
thanks: "Code and data are available at: https://github.com/sarahmansoorr/SUDS2022"
date: "`r format(Sys.time(), '%d %B %Y')`"
format: pdf
editor: visual
abstract: "Climate change has a growing impact in Canada. This paper analyses the trends in temperature and pollution levels in Toronto over the last 20 years using exploratory analysis, data visualization, and regression analysis. Temperatures have continued to increase since 2002 and winters are experiencing less extreme cold while summers are experiencing more extreme heat. Further, pollution levels for NO (Nitric Oxide), NO2 (Nitrogen Dioxide), CO (Carbon Monoxide), and SO2 (Sulfur Dioxide) have decreased since 2002 which may be related to laws and regulations. Data visualizations showed that these pollutants appear to have higher levels in winter months while O3 (Ozone) pollution levels have remained mostly the same since 2002 and O3 levels have higher maximums in summer months. The presence of these pollutants has detrimental health effects for the Toronto population including lung irritation, increase in allergens for those with asthma, respiratory illnesses, heart disease, cardiovascular diseases, and reduced lung function. Understanding which pollutants are most problematic during particular months can enable further research which would reduce their effects on health."
toc: true
bibliography: references.bib
---

\newpage

## Introduction

As climate change worsens, the danger it presents to human health becomes more and more dangerous [@citenasaclimatewarn]. The health impacts due to climate change are already being demonstrated in parts of Canada. Canada is warming at almost twice the global rate and if this continues, emissions will exceed 2 degrees Celsius worldwide [@citehealthcanada].

The Paris Agreement within the United Nations Framework Convention on Climate Change includes 175 countries that have agreed to limit the average global temperature rise to below 2 degress Celcius [@citehealthcanada]. Canada had signed to the Paris Agreement as well and committed to cutting emissions 30% below the 2005 levels by 2030 [@citehealthcanada]. However, Canada's emissions increased in 2016 compared to 1990. In response to this increase, the Government of Canada developed a national climate change plan called *The Pan-Canadian Framework on Clean Growth and Climate Change* [@citehealthcanada]. This framework notes that human activities are driving severe changes to the Earth's climate which poses substantial risks to human health.

Urgent action is needed and the science shows that it will make a tangible difference \[\@\]. The health impacts from climate change can be mitigated by improving efforts both in societies and health systems in Canada \[\@\]. Changes in measures can prevent health impacts and build health systems and facilities that are more resilient to climate change \[\@\].

Data was collected from the Government of Canada's website for both temperature and pollution. Once the data was collected for the available years between 2002 and 2022, it was cleaned using multiple packages in R which will be described in the next section.

This paper outlines the data, how it was collected, variables of interest and how the data was processed and cleaned. Following this, the trends in temperature from 2002 to 2022 will be analyzed followed by the trends in pollution levels for each pollutant from 2002 to 2020. From here, the relationship between pollution levels and temperature will be analyzed followed by limitations and results and lastly next steps to take.

## Data

#### Data Collection

Temperature data was collected from the Government of Canada's website on Weather, Climate and Hazard's [page](https://climate.weather.gc.ca/historical_data/search_historic_data_e.html) containing past weather and climate data for the station "Toronto City". This data was collected from January 2002 to May 2022. The original data contains daily data on maximum temperature, minimum temperature, and mean temperature among others. This paper focuses on only maximum temperature, minimum temperature, and mean temperature.

Pollution data was collected from the Government of Canada's National Air Pollution Surveillance (NAPS) Program [website](https://data-donnees.ec.gc.ca/data/air/monitor/national-air-pollution-surveillance-naps-program/Data-Donnees/?lang=en). This website contains pollution data from 2002 to 2020. Each year contains a file with continuous data and integrated data. Continuous data for each year will be used. The continuous data contains annual summaries and hourly data. The analysis will use the hourly data for CO (Carbon Monoxide), NO (Nitric Oxide), NO2 (Nitrogen Dioxide) , O3 (Ozone), and SO2 (Sulfur Dioxide). This data includes the city (which is Toronto in our case), the levels of each pollutant for each hour of every day. The data was reduced to the mean of pollution levels by pollutant of each day.

#### Variables of Interest

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Load libraries
library(tidyverse)
library(knitr)
library(kableExtra)
library(ggplot2)
library(dplyr)
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="", fig.width=9, fig.height=3.2}

temp_var <- c("City", "Maximum Temperature", "Minimum Temperature", "Mean Temperature", "Day", "Month", "Year")

pollu_var <- c("City", "Pollutant", "Mean Pollution Level", "Day", "Month", "Year", "")

df <- data.frame(temp_var, pollu_var)

df %>% select(temp_var, pollu_var) %>%
  kable(
    col.names=c("Temperature Variables of Interest", "Pollution Variables of Interest"),
    linesep = "", digits = 2, booktabs=TRUE) %>%
  kable_styling(latex_options = "HOLD_position", font_size = 10)

```

#### Data Processing

*Temperature data*

The data for temperature was processed using R studio and R [@citeR]. The 2002 to 2022 temperature data was combined together. The data set initially contained 31 variables. From these the city, date, year, month, day, maximum temperature, minimum temperature, and mean temperature were selected using the dplyr package [@citedplyr]. Then any NA values from the maximum, minimum, and mean temperature columns were dropped.

*Pollution Data*

The pollution data was also processed using R studio and R. The different data sets for each pollutant for each year were first loaded. Each year had 5 data sets for each pollutant (NO, NO2, CO, O3, SO2). The pollutant data sets for each year were combined into one data frame for the year. The data initially contained 27 columns including pollution levels for each hour of every day in the respective year. These 24 columns (for each hour of the day) were replaced with one column that contained the mean pollution level for that day and pollutant. Toronto was filtered from the list of cities in the data set using the dplyr package [@citedplyr] and the duplicate rows were removed where the pollutant and date repeated. This process was repeated for all years from 2002 to 2020. Once this was completed, the data was combined for all the years into one data frame and the following columns were selected: city, pollutant, mean pollution, day, month, year. The units for CO were ppm (part per million) while the rest were ppb (part per billion). These units are used to describe the concentration of gases in atmospheric chemistry [@citeppmppb]. To keep the data consistent, those values were converted to ppb as well by multiplying by 1,000.

#### The Sample

#### The Data

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Load temperature data

temp_2002_2022 <- read.csv("~/Desktop/SUDS2022/inputs/data/clean_temp_data/temperature_2002_2022.csv")

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="", fig.width=9, fig.height=3.2}

temp_2002_2022 %>%
  select(year, month, day, max_temp, min_temp, mean_temp) %>%
  slice(c(162, 393, 4222, 5222, 6333)) %>%
  kable(
    caption = "Extracting rows from the Temperature data from 2002 - 2022",
    col.names=c("Year", "Month", "Day", "Max Temp", "Min Temp", "Mean Temp"),
    linesep = "", digits = 2, booktabs=TRUE) %>%
  kable_styling(latex_options = "HOLD_position", font_size = 10)

```

Table 1 shows some of the rows of the Temperature data from 2002 to 2022.

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Load pollution data

pollution <- read.csv("~/Desktop/SUDS2022/inputs/data/clean_pollution_data/pollution_2002_2020.csv")

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="", fig.width=9, fig.height=3.2}

pollution %>%
  select(city, pollutant, mean_pollution, day, month, year) %>%
  slice(c(100, 1000, 5000, 11000, 15000)) %>%
  kable(
    caption = "Extracting rows from the Pollution data from 2002 - 2020",
    col.names=c("City", "Pollutant", "Mean Pollution", "Day", "Month", "Year"),
    linesep = "", digits = 2, booktabs=TRUE) %>%
  kable_styling(latex_options = "HOLD_position", font_size = 10)

```

Table 2 shows some of the rows of the Pollution data from 2002 to 2020. Variable "Mean Pollution" represents the mean pollution levels of the following pollutant on the following day of the month and year.

## Visualizing Temperature from 2002-2022

#### Visualizing Temperature by Month and Year

This section is interested in finding the trends of the maximum temperatures from 2002 to 2022 by the month and year.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Temperature 2002 to 2012 for December to March", fig.width=9, fig.height=3.2}

level_order <- c("Dec", "Jan", "Feb","Mar")

temp_2002_2022 %>% filter((month_name == "Dec" | month_name == "Jan"| month_name == "Feb" | month_name == "Mar") & (year >= 2002 & year <= 2012)) %>% ggplot(aes(x=year, y=max_temp, color=factor(month_name, level = level_order))) + geom_point(alpha = 0.4) + labs(color="Month") + xlab("Year") + ylab("Maximum Temperature") + theme_bw() + facet_grid(. ~ month_name) + scale_x_discrete(breaks = 0:2100)

```

Figure 1 shows an increasing pattern for the maximum temperature from year 2002 to 2012 from December to March. Temperatures in March continue to be increasingly higher than any of the other months in this plot. It is noticeable that the temperatures for all months are the highest in 2012. According to NASA, the average temperatures in 2012 was warmer than the mid-20th century baseline and is considered to be an outlying of seasonal extremes that are warmer [@citenasaclimatewarn]. The lowest maximum temperature in January is higher than other years in 2012. The plot shows that the average maximum temperature from December to March has been between -19.2 degrees Celsius in February of 2015 and 24.3 degrees Celsius in March of 2012.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Temperature 2013 to 2022 for December to March", fig.width=9, fig.height=3.2}

temp_2002_2022 %>% filter((month_name == "Dec" | month_name == "Jan"| month_name == "Feb" | 
                             month_name == "Mar") & (year > 2012 & year <= 2022)) %>% ggplot(aes(x=year, y=max_temp, 
                                                                                                  color=factor(month_name, level = level_order))) + 
  geom_point(alpha = 0.4) + labs(color="Month") + xlab("Year") + ylab("Maximum Temperature") + 
  theme_bw() + facet_grid(. ~ month_name) + scale_x_discrete(breaks = 0:2100)

```

Figure 2 shows an increasing pattern for the maximum temperature from year 2013 to 2022 from December to March.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Temperature 2002 to 2012 for April to July", fig.width=9, fig.height=3.2}

level_order <- c("Apr", "May", "Jun", "Jul")

temp_2002_2022 %>% filter((month_name == "Apr" | month_name == "May" | month_name == "Jun" | month_name == "Jul") & (year >= 2002 & year <= 2012)) %>% ggplot(aes(x=year, y=max_temp, color=factor(month_name, level = level_order))) + geom_point(alpha = 0.4) + labs(color="Month") + xlab("Year") + ylab("Maximum Temperature") + theme_bw() + facet_grid(. ~ month_name) + scale_x_discrete(breaks = 0:2100)

```

Figure 3 shows an increasing pattern for the maximum temperature from year 2002 to 2012 from April to July. Temperatures in July are consistently higher throughout the years than any of the other months in the plot and temperatures in April are consistently lower throughout the years than any of the other months. There are some years where June has the highest temperature. The plot shows that the average maximum temperature from April to May has been between -2.4 degrees Celsius in April of 2003 and 38.2 degrees Celsius in July of 2011.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Temperature 2013 to 2022 for April to July", fig.width=9, fig.height=3.2}

level_order <- c("Apr", "May", "Jun", "Jul")

temp_2002_2022 %>% filter((month_name == "Apr" | month_name == "May" | month_name == "Jun" | month_name == "Jul") & (year > 2012 & year <= 2022)) %>% ggplot(aes(x=year, y=max_temp, color=factor(month_name, level = level_order))) + geom_point(alpha = 0.4) + labs(color="Month") + xlab("Year") + ylab("Maximum Temperature") + theme_bw() + facet_grid(. ~ month_name) + scale_x_discrete(breaks = 0:2100)

```

Figure 4 shows an increasing pattern for the maximum temperature from year 2013 to 2022 from April to July.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Temperature 2002 to 2012 for August to November", fig.width=9, fig.height=3.2}

level_order <- c("Aug","Sep", "Oct","Nov")

temp_2002_2022 %>% filter((month_name == "Aug" | month_name == "Sep" | month_name == "Oct" | month_name == "Nov") & (year >= 2002 & year <= 2012)) %>% ggplot(aes(x=year, y=max_temp, color=factor(month_name, level = level_order))) + geom_point(alpha = 0.4) + labs(color="Month") + xlab("Year") + ylab("Maximum Temperature") + theme_bw() + facet_grid(. ~ month_name) + scale_x_discrete(breaks = 0:2100)

```

Figure 5 shows an increasing pattern for the maximum temperature from year 2002 to 2012 from August to November. Temperatures in both August and September are the highest throughout the years compared to November and October. Temperatures in November are consistently the lowest throughout the years compared to the other months. There are a few high temperatures in October throughout the years as well and this is typically seen when the August and September have some of the highest temperatures compared to other years. The plot shows that the average maximum temperature from April to May has been between -5.1 degrees Celsius in November of 2018 and 36.8 degrees Celsius in August of 2006.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Temperature 2013 to 2022 for August to November", fig.width=9, fig.height=3.2}

level_order <- c("Aug","Sep", "Oct","Nov")

temp_2002_2022 %>% filter((month_name == "Aug" | month_name == "Sep" | month_name == "Oct" | month_name == "Nov") & (year > 2012 & year <= 2022)) %>% ggplot(aes(x=year, y=max_temp, color=factor(month_name, level = level_order))) + geom_point(alpha = 0.4) + labs(color="Month") + xlab("Year") + ylab("Maximum Temperature") + theme_bw() + facet_grid(. ~ month_name) + scale_x_discrete(breaks = 0:2100)


```

Figure 6 shows an increasing pattern for the maximum temperature from year 2013 to 2022 from August to November.

## Visualizing Pollution from 2002-202

This section is interested in finding the trends of the mean pollution levels from 2002 to 2020 by year.

#### Visualizing NO (Nitric Oxide)

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for NO by Year", fig.width=9, fig.height=3.2}

level_order <- c("Jan", "Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug","Sep", "Oct","Nov", "Dec")

pollution %>% filter(pollutant == "NO") %>% ggplot(
  aes(x = year, y = mean_pollution, factor(month_name, level = level_order))) +
  geom_point(color = "gray") + labs(color="Month") + xlab("Year") + ylab("Mean Pollution (ppb)") + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for NO by Month", fig.width=9, fig.height=3.2}

level_order <- c("Jan", "Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug","Sep", "Oct","Nov", "Dec")

pollution %>% filter(pollutant == "NO") %>% ggplot(
  aes(x = factor(month_name, level = level_order), y = mean_pollution)) + geom_point(color = "gray") +
  xlab("Month") + ylab("Mean Pollution (ppb)") + theme_bw()
```

Figure 7 shows a decreasing pattern for the mean pollution from year 2002 to 2020 for NO by year. The highest pollution level for NO was 150.3 ppb in 2002. Figure 8 shows a decreasing trend from 2002 to 2020 of the level of nitric oxide in the air. This figure shows that in the colder months the levels of NO in the air are much higher than in the warmer months. The highest level in 2020 was around 49 ppb, a drastic drop from 2002. The highest level that was mentioned previously was seen in the month of December. However, it looks like on average the level of pollution for winter months is around 80 ppb. There are only some points that show high levels for the winter months.

#### Visualizing NO2 (Nitrogen Dioxide)

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for NO2 by Year", fig.width=9, fig.height=3.2}

pollution %>% filter(pollutant == "NO2" ) %>% ggplot(
  aes(x = year, y = mean_pollution)) + geom_point(color = "light blue") + 
  labs(color="Pollutant") + xlab("Year") + ylab("Mean Pollution (ppb)") + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for NO2 by Month", fig.width=9, fig.height=3.2}

level_order <- c("Jan", "Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug","Sep", "Oct","Nov", "Dec")

pollution %>% filter(pollutant == "NO2") %>% ggplot(
  aes(x = factor(month_name, level = level_order), y = mean_pollution)) + geom_point(color = "light blue") +
  ylab("Mean Pollution (ppb)") + theme_bw()
```

Figure 9 shows the mean pollution for NO2 has been consistently decreasing from 2002 to 2020. The highest value was seen in 2005 where the level was 65 ppb.The highest level in 2020 was around 31 ppb. There are some years between 2002 and 2020 where the level increases again in 2011 and 2014. The mean levels of pollution by month in figure 9 appear to have higher levels in the winter months than in the summer months, but not by a lot. The average levels are around 40 ppb for most months.

#### Visualizing O3 (Ozone)

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for O3 by Year", fig.width=9, fig.height=3.2}

pollution %>% filter(pollutant == "O3") %>% ggplot(
  aes(x = year, y = mean_pollution)) + geom_point(color = "light pink") + 
  xlab("Year") + ylab("Mean Pollution (ppb)") + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for O3 by Month", fig.width=9, fig.height=3.2}

level_order <- c("Jan", "Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug","Sep", "Oct","Nov", "Dec")

pollution %>% filter(pollutant == "O3") %>% ggplot(
  aes(x = factor(month_name, level = level_order), y = mean_pollution)) + geom_point(color = "light pink") +
  xlab("Month") + ylab("Mean Pollution (ppb)") + theme_bw()
```

In figure 10, we can see that the mean pollution levels for ozone do not change much from 2002 to 2020. There is a slight decrease from the earlier years to the more recent years but not much. The highest level of CO was in 2003 with 65.95 ppb. In 2006, 2008, and 2012 the levels were also higher than 60 ppb. The average high levels are around 50 pb and that does not change from 2002 to 2020. This suggests that the level of ozone in our air has not been getting better and continues to affect our air and health. In figure 11, the hotter months for O3 have higher levels of pollution than the winter months. This suggests that ozone has a relationship with the high levels of temperature and that may be why the levels of pollution have not decreased since 2002, as our average global temperatures also keep rising. The highest value of 65.95 ppb was seen in June.

#### Visualizing CO (Carbon Monoxide)

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for CO by Year", fig.width=9, fig.height=3.2}

pollution %>% filter(pollutant == "CO") %>% ggplot(
  aes(x = year, y = mean_pollution)) + geom_point(color = "#9AD67F") + 
  labs(color="Pollutant") + xlab("Year") + ylab("Mean Pollution (ppb)") + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for CO by Month", fig.width=9, fig.height=3.2}

level_order <- c("Jan", "Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug","Sep", "Oct","Nov", "Dec")

pollution %>% filter(pollutant == "CO") %>% ggplot(
  aes(x = factor(month_name, level = level_order), y = mean_pollution)) + geom_point(color = "#9AD67F") +
  xlab("Month") + ylab("Mean Pollution (ppb)") + theme_bw()
```

Carbon monoxide is produced through burning of coal, gasoline, natural gas, oil, propane, and wood [@citeCOpoisoning]. In figure 12 and 13 we see a similar pattern as NO and NO2 where the level of pollution is decreasing throughout the years from 2002 to 2020 and the highest levels are in the winter months. The highest level of pollution for CO was seen in 2002 with 1762.5 ppb. This level is much higher than any of the other pollutants. This suggests that carbon monoxide levels are much more widespread than any of the other pollutants we have analyzed and due to this can have a affect on our health. Even with the decreasing levels, the affects will still be dangerous. The highest level in 2020 was around 550 ppb which is almost 5 times higher than the levels of NO, NO2, and O3 in 2020. There is also a decreasing pattern for the mean pollution from year 2002 to 2020 for CO by year. It can be noticed that there is a drop in the pollution levels from 2003 to 2005 but it rises again in 2006. Looking back at figure 3, this was the same year some of the highest temperatures were recorded from August to November. The highest levels of CO are during winter and the colder months. This might be due to the fact that heaters are used the most in this time and do emit carbon monoxide. This plot does not tell us much else about the other pollutants due so from here we will take a look at each pollutant and how it has behaved from 2002 to 2020 by year and month.

#### Visualizing SO2 (Sulfur Dioxide)

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for SO2 by Year", fig.width=9, fig.height=3.2}

pollution %>% filter(pollutant == "SO2") %>% ggplot(
  aes(x = year, y = mean_pollution)) + geom_point(color = "#847FD6") + 
  xlab("Year") + ylab("Mean Pollution (ppb)") + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for NO by Month", fig.width=9, fig.height=3.2}

level_order <- c("Jan", "Feb","Mar", "Apr", "May", "Jun", "Jul", "Aug","Sep", "Oct","Nov", "Dec")

pollution %>% filter(pollutant == "SO2") %>% ggplot(
  aes(x = factor(month_name, level = level_order), y = mean_pollution)) + geom_point(color = "#847FD6") +
  xlab("Month") + ylab("Mean Pollution (ppb)") + theme_bw()
```

In figure 14, there is a decreasing pattern for the level of SO2 in the air from 2002 to 2020. The highest level in 2002 was 22.79 ppb and the highest level in 2020 seems to be less than 3 ppb. This is a drastic drop and suggests that the level of SO2 in the air is not affected by the increasing temperatures. This is also seen in figure 15. The levels of SO2 in the air remain consistent throughout the months and there is no difference between the winter and summer months.

## Visualizing Pollution and Temperature from 2002-2020

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Load pollution and temperature data

pollu_temp <- read.csv("~/Desktop/SUDS2022/inputs/data/clean_temperature_pollution.csv")
```

#### Visualizing Mean Pollution by Temperature and Pollutant

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for NO, NO2, O3 and SO2 by Maximum Temperature and Pollutant for December to March", fig.width=9, fig.height=3.2}

pollu_temp %>% filter((pollutant != "CO" & pollutant != "SO2")) %>% ggplot(aes(max_temp, mean_pollution)) + geom_point(color = "#6DD6CD", alpha = 0.4) + facet_grid(. ~ pollutant) + xlab("Maximum Temperature") +  ylab("Mean Pollution") + theme_bw()
```

In figure 16,

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for CO by Maximum Temperature and Pollutant for December to March", fig.width=9, fig.height=3.2}

pollu_temp %>% filter((pollutant == "CO")) %>% ggplot(aes(max_temp, mean_pollution)) + geom_point(color = "#6DD6CD", alpha = 0.4) + facet_grid(. ~ pollutant) + xlab("Maximum Temperature") +  ylab("Mean Pollution") + theme_bw()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Mean Pollution 2002 to 2020 for NO, NO2, O3 and SO2 by Maximum Temperature and Pollutant for April to July", fig.width=9, fig.height=3.2}

pollu_temp %>% filter((pollutant == "SO2")) %>% ggplot(aes(max_temp, mean_pollution)) + geom_point(color = "#6DD6CD", alpha = 0.4) + facet_grid(. ~ pollutant) + xlab("Maximum Temperature") +  ylab("Mean Pollution") + theme_bw()

```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=3.2}

model2 <- lm(mean_pollution ~ max_temp , pollu_temp)
# summary(model2)

formula_1 <- c("formula = mean_pollution ~ max_temp", " ")
coefficients_1 <- c("Intercept", "Max Temp")
estimate <- c(82.0493, -0.2965)
error <- c(1.6927, 0.0984)
t_value <- c(48.473, -3.014)
p_value <- c("< 2e-16", "0.00259")

df <- data.frame(formula_1, coefficients_1, estimate, error, t_value, p_value)
df %>% select(formula_1, coefficients_1, estimate, error, t_value, p_value) %>%
  kable(
    col.names=c("Formula", "Coefficients", "Estimate", "Error", "t-value", "p-value"),
    linesep = "", digits = 2, booktabs=TRUE) %>%
  kable_styling(latex_options = "HOLD_position", font_size = 10)
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=3.2}

model3 <- lm(mean_pollution ~ max_temp + min_temp + mean_temp , pollu_temp)
# summary(model3)

formula_1 <- c("formula = mean_pollution ~ max_temp + ", "min_temp + mean_temp", " ", " ")
coefficients_1 <- c("Intercept", "Max Temp", "Min Temp", "Mean Temp")
estimate <- c(78.654, -45.867, -46.606, 91.978)
error <- c(2.903, 18.927, 19.010, 37.870)
t_value <- c(27.090, -2.423, -2.452, 2.429)
p_value <- c("< 2e-16", "0.0154", "0.0142", "0.0152")

df <- data.frame(formula_1, coefficients_1, estimate, error, t_value, p_value)
df %>% select(formula_1, coefficients_1, estimate, error, t_value, p_value) %>%
  kable(
    col.names=c("Formula", "Coefficients", "Estimate", "Error", "t-value", "p-value"),
    linesep = "", digits = 2, booktabs=TRUE) %>%
  kable_styling(latex_options = "HOLD_position", font_size = 10)
```

## Limitations

This limitations section will focus on the data used and look into why it is not easy to take the implications mentioned above directly.

### Missing Pollution Data from 2021-2022

## Results and Discussion

Toronto will continue to experience warmer climate in the long-term due to climate change [@citefutureclimate]. Toronto will have more extreme hot days where the temperature will be above 30 degrees celcius and less extreme cold days where the temperature will be below -20 degrees celcius [@citefutureclimate]. By 2100, Toronto is expected to have warmed by 5 degrees celcius [@citefutureclimate]. These warmer temperatures have significant impacts on the health and well-being of Toronto residents. If carbon emissions continue and no changes are put in place now, the maximum average annual temperatures are expected to be: 12-14 degrees celcius by 2040, 14-16 degrees celcius by 2070, and 16-18 degrees celcius by 2100 [@citefutureclimate]. With more extreme heat days, Toronto will experience a greater demand for cooling which will increase the use of air conditioning causing a strain on electrical supply. These increases can be seen in figures 1, 2 and 3. In these we saw an increase in average temperatures for the Fall, Winter and Summer months.

Air pollution continues to affect Canadians. Smog in the air, which is a mixture of smoke and fog, contains O3, SO2, and NO. Air pollutants like these are influenced by many factors including air temperature. Canada's population and economy continues to grow thus increasing the demand for production and delivery. This means more energy will be used to meet these demands and most of this energy will come from fossil fuels which will impact the quality of the air.

From the analysis of NO, NO2, CO and SO2 it was seen that there was a decline in the mean pollution levels of those pollutants. This is due to implementation of regulations and technological improvements for transportation vehicles and industrial processes. Canadians using more environmentally sustainable practices like public transport and carpooling have contributed to the decrease of lower pollution levels.

NO2 is usually formed through the burning of fossil fuels, transportation services, energy production and industrial processes [@citeairquality]. Nitrogen dioxide at higher concentration levels has a strong and harsh odor and can be seen over large cities as a brownish haze [@citeairquality]. NO2 can combine with H2O and form nitric acid and nitrous acid. This falls to earth through precipitation like rain, snow, and fog, and contributed to acidification and eutrophication of ecosystems [@citeairquality]. NO2 (Nitrogen Dioxide) has consequences on human health including emergency hospitalizations for respiratory conditions for adults that live in lower income communities in Toronto \[\@citestatscan\]. Children are more vulnerable to these effects of respiratory damage \[\@citestatscan\]. Children that have been exposed to NO2 have an increased risk of asthma, wheezing, infections in the ear, nose and throat, influenza, serious colds, and reduced lung function \[\@citestatscan\].

SO2 emissions come from natural sources like volcanoes and forest fires but these emissions are small compared to those from industrial sources [@citeairquality]. Environment Canada accounted for 1 million tonnes of man-made SO2 emissions compared to 100 tonnes of natural SO2 emissions in 2022. SO2 is seen in acid rain and due to this early recognition policies were put in place that have reduced SO2 pollution in recent decades as seen in figure 14. SO2 (Sulfur Dioxide) can harm human respiratory systems by triggering respiratory illness and worsening existing respiratory and cardiovascular diseases [@citepembinainstitute]. Sulfur dioxide is seen in smog and can react with other substances like nitric oxide to harm human health [@citeconferenceboard]. When SO2 transforms into sulfate particles and combines with other particles in the atmosphere it can contribute to the formation of particulate matter (PM2.5) which harms human health as well as the environment [@citeconferenceboard]. Sensitive populations such as children, the elderly, those with asthma are more susceptible to the affects of SO2 [@citepembinainstitute].

Exposure to NO (Nitric Oxide) can irritate the lungs, reduce lung function and increase vulnerability to allergens for those with asthma [@citeairquality]. Nitric Oxide is seen in smog and can react with other substances to harm human health.

O3 (Ozone) is the main component of smog and has been associated with eye, nose, and throat irritations [@citeairquality]. Ozone also causes shortness of breath, aggravation of respiratory conditions and allergies, chronic obstructive pulmonary disease and asthma [@citeairquality]. Increased risk of cardiovascular disease is a result of exposure to O3 as well and all of these symptoms affect the young and the elderly that live near cities and/or with acute illnesses [@citeairquality].

Carbon monoxide can significantly impact human health by entering the blood stream through the lungs and therefore inhibiting the blood's capacity to carry oxygen to organs and tissues [@citegovCanAirPoll]. CO is harmful to those with heart disease and those with respiratory conditions. It also affects healthy individuals by reducing their exercise capacity, visual perception, manual dexterity, learning functions, and ability to perform complex tasks [@citegovCanAirPoll].

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=3.2}

r <- pollution %>% filter((pollutant == "NO")) %>% select(mean_pollution)
rr <- range(r)
# 0.0000 150.2917
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 13.60186

r <- pollution %>% filter((pollutant == "NO2")) %>% select(mean_pollution)
rr <- range(r)
#  0 65
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 14.97535

r <- pollution %>% filter((pollutant == "O3")) %>% select(mean_pollution)
rr <- range(r)
# 0.00000 65.95833
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 22.98821

r <- pollution %>% filter((pollutant == "SO2")) %>% select(mean_pollution)
rr <- range(r)
# -0.02500 22.79167
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 1.233524

r <- pollution %>% filter((pollutant == "CO")) %>% select(mean_pollution)
rr <- range(r)
# 0.0 1762.5
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 254.4278

pollutants <- c("NO", "NO2", "O3", "SO2", "CO")
means_pollutants <- c(13.60, 14.97, 22.99, 1.23, 254.43) 

df <- data.frame(pollutants, means_pollutants)

df %>%
  select(pollutants, means_pollutants) %>%
  kable(
    caption = "Mean Pollution Levels of Each Pollutant",
    col.names=c("Pollutant", "Mean Pollution Level"),
    linesep = "", digits = 2, booktabs=TRUE) %>%
  kable_styling(latex_options = "HOLD_position", font_size = 10)

```

Table 3 shows the mean pollution levels of each pollutant from 2002 to 2020. The highest mean is from CO levels followed by O3. From the previous analysis, carbon monoxide is produced through burning of coal, gasoline, natural gas, oil, propane, and wood and as these activities have been continuing throughout the city of Toronto thus CO levels remain high [@citeCOpoisoning]. O3 levels have also been increasing from 2002 to 2020 while the remaining pollutants' levels (NO, NO2, and SO2) have been decreasing in that time.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=3.2}

# NO

r <- pollution %>% filter((pollutant == "NO") & (year == 2002 | year == 2003 |
                                                 year == 2004 | year == 2005 | 
                                                   year == 2006)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 15.04657

r <- pollution %>% filter((pollutant == "NO") & (year == 2007 | year == 2008 |
                                                   year == 2009 | year == 2010 | 
                                                   year == 2011)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 8.573613

r <- pollution %>% filter((pollutant == "NO") & (year == 2012 | year == 2013 |
                                                   year == 2014 | year == 2015 | 
                                                   year == 2016)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 5.852171

r <- pollution %>% filter((pollutant == "NO") & (year == 2017 | year == 2018 |
                                                   year == 2019 | year == 2020)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 3.250599


# NO2

r <- pollution %>% filter((pollutant == "NO2") & (year == 2002 | year == 2003 |
                                                   year == 2004 | year == 2005 | 
                                                   year == 2006)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 19.87938

r <- pollution %>% filter((pollutant == "NO2") & (year == 2007 | year == 2008 |
                                                   year == 2009 | year == 2010 | 
                                                   year == 2011)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 15.56782

r <- pollution %>% filter((pollutant == "NO2") & (year == 2012 | year == 2013 |
                                                   year == 2014 | year == 2015 | 
                                                   year == 2016)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 13.39803

r <- pollution %>% filter((pollutant == "NO2") & (year == 2017 | year == 2018 |
                                                   year == 2019 | year == 2020)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 10.07811


# O3

r <- pollution %>% filter((pollutant == "O3") & (year == 2002 | year == 2003 |
                                                    year == 2004 | year == 2005 | 
                                                    year == 2006)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 20.94733

r <- pollution %>% filter((pollutant == "O3") & (year == 2007 | year == 2008 |
                                                    year == 2009 | year == 2010 | 
                                                    year == 2011)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 22.5484

r <- pollution %>% filter((pollutant == "O3") & (year == 2012 | year == 2013 |
                                                    year == 2014 | year == 2015 | 
                                                    year == 2016)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 23.97225

r <- pollution %>% filter((pollutant == "O3") & (year == 2017 | year == 2018 |
                                                    year == 2019 | year == 2020)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 24.85809


# SO2

r <- pollution %>% filter((pollutant == "SO2") & (year == 2002 | year == 2003 |
                                                   year == 2004 | year == 2005 | 
                                                   year == 2006)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 2.476657

r <- pollution %>% filter((pollutant == "SO2") & (year == 2007 | year == 2008 |
                                                   year == 2009 | year == 2010 | 
                                                   year == 2011)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 1.276447

r <- pollution %>% filter((pollutant == "SO2") & (year == 2012 | year == 2013 |
                                                   year == 2014 | year == 2015 | 
                                                   year == 2016)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 0.6760719

r <- pollution %>% filter((pollutant == "SO2") & (year == 2017 | year == 2018 |
                                                   year == 2019 | year == 2020)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 0.3232774


# CO

r <- pollution %>% filter((pollutant == "CO") & (year == 2002 | year == 2003 |
                                                    year == 2004 | year == 2005 | 
                                                    year == 2006)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 314.0882

r <- pollution %>% filter((pollutant == "CO") & (year == 2007 | year == 2008 |
                                                    year == 2009 | year == 2010 | 
                                                    year == 2011)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 223.6469

r <- pollution %>% filter((pollutant == "CO") & (year == 2012 | year == 2013 |
                                                    year == 2014 | year == 2015 | 
                                                    year == 2016)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 244.8328

r <- pollution %>% filter((pollutant == "CO") & (year == 2017 | year == 2018 |
                                                    year == 2019 | year == 2020)) %>% select(mean_pollution)
rm <- mean(as.numeric(r$mean_pollution),na.rm=TRUE)
# 230.332


pollutants <- c("NO", "NO", "NO", "NO", 
                "NO2", "NO2", "NO2", "NO2",
                "O3", "O3", "O3", "O3", 
                "SO2", "SO2", "SO2", "SO2", 
                "CO", "CO", "CO", "CO")
year <- c("2002 to 2006", "2007 to 2011", "2012 to 2016", "2017 to 2020", 
          "2002 to 2006", "2007 to 2011", "2012 to 2016", "2017 to 2020",
          "2002 to 2006", "2007 to 2011", "2012 to 2016", "2017 to 2020", 
          "2002 to 2006", "2007 to 2011", "2012 to 2016", "2017 to 2020", 
          "2002 to 2006", "2007 to 2011", "2012 to 2016", "2017 to 2020")
means_pollutants <- c(15.05, 8.57, 5.85, 3.25,
                      19.88, 15.57, 13.40, 10.1,
                      20.95, 22.55, 23.97, 24.86, 
                      2.48, 1.28, 0.68, 0.32, 
                      314.1, 223.65, 244.83, 230.33)

df <- data.frame(pollutants, means_pollutants, year)
df %>%
  select(pollutants, means_pollutants, year) %>%
  kable(
    caption = "Mean Pollution Levels of Each Pollutant by 5-Year Intervals",
    col.names=c("Pollutant", "Mean Pollution Level", "5-Year Interval"),
    linesep = "", digits = 2, booktabs=TRUE) %>%
  kable_styling(latex_options = "HOLD_position", font_size = 10)
```

Table 4 shows the mean pollution levels of each pollutant by five-year intervals. From this table, it is evident that NO, NO2, SO2, and CO levels have been decreasing since 2002 while O3 has been increasing. The levels of CO still remain higher than any of the other pollutants. The biggest difference in pollution levels are seen for NO. From 2002 to 2006 the mean was 15.05 but this dropped to 3.25 from 2017 to 2020.

When looking at temperature, pollution and health together there are trends that have been analyzed in this paper that show that with temperature increases, there are higher levels of O3 (Ozone) and CO (Carbon Monoxide) levels have remained high. With the high presence of these pollutants in the air of Toronto, the population faces health risks that include reducing their exercise capacity, visual perception, manual dexterity, learning functions, ability to perform complex tasks, shortness of breath, aggravation of respiratory conditions and allergies, chronic obstructive pulmonary disease and asthma.

## Next Steps

Following on from the previous section, good suggestions can be made on ways to improve the data so that the findings will be less ambiguous and more ethical to use with confidence. First off, by collecting pollution data from 2021 to 2022. It is possible that this data is available but not published yet on the website. In doing this, the data scientist who gets a hold of the data will have the liberty to conduct their analysis with the full data sets for temperature and pollution for 20 years. This will not only ease the job of the data scientist but will also improve the reproducibility of their workflow and finding.

\newpage

## References
